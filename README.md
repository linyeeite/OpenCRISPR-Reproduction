# OpenCRISPR-Reproduction ğŸ§¬

### ğŸ“– é¡¹ç›®ç®€ä»‹
æœ¬é¡¹ç›®æ˜¯å¯¹ **ProGen2** è›‹ç™½è´¨è¯­è¨€æ¨¡å‹åœ¨ CRISPR-Cas9 ç³»ç»Ÿä¸­åº”ç”¨çš„å·¥ç¨‹å¤ç°ä¸æœºç†ç ”ç©¶ã€‚
åŸºäº Salesforce çš„ ProGen2-Small æ¶æ„ï¼Œæœ¬é¡¹ç›®å®ç°äº†ä»**åºåˆ—ç”Ÿæˆ**åˆ°**æ³¨æ„åŠ›æœºåˆ¶å¯è§†åŒ–**çš„å®Œæ•´æµç¨‹ï¼Œé‡ç‚¹éªŒè¯äº† Transformer æ¶æ„åœ¨ç”Ÿç‰©åºåˆ—ä¸­çš„é•¿è·ç¦»ä¾èµ–æ•æ‰èƒ½åŠ›ã€‚

---

### ğŸ› ï¸ æ ¸å¿ƒå·¥ä½œ (Key Contributions)

* **âš¡ å·¥ç¨‹å¤ç°**
    è§£å†³äº† ProGen2 æ—§ç‰ˆæ¶æ„ä¸ Hugging Face æ–°ç‰ˆ `transformers` åº“çš„ `DynamicCache` å…¼å®¹æ€§é—®é¢˜ï¼Œé€šè¿‡è¿è¡Œæ—¶è¡¥ä¸ï¼ˆRuntime Patchingï¼‰ä¿®å¤äº† KV Cache æ¥å£å†²çªã€‚

* **ğŸ§  æ¨ç†ä¼˜åŒ–**
    é’ˆå¯¹æ¨¡å‹ä¸Šä¸‹æ–‡çª—å£ï¼ˆ1024 tokensï¼‰é™åˆ¶ï¼Œå®ç°äº†åŸºäº `max_new_tokens` çš„ç”Ÿæˆç­–ç•¥ï¼ŒæˆåŠŸç”Ÿæˆäº†å…·æœ‰ç”Ÿç‰©å­¦æ„ä¹‰çš„ Cas9 ç‰‡æ®µã€‚

* **ğŸ” æ·±åº¦è§£é‡Šæ€§åˆ†æ**
    * **Mask æœºåˆ¶éªŒè¯**ï¼šé€šè¿‡æ³¨æ„åŠ›çƒ­åŠ›å›¾éªŒè¯äº† Causal Maskingï¼ˆå› æœæ©ç ï¼‰çš„æœ‰æ•ˆæ€§ï¼ˆå¯¹è§’çº¿ç‰¹å¾ï¼‰ã€‚
    * **å¤šå¤´æ³¨æ„åŠ›åˆ†å·¥**ï¼šå¯è§†åŒ–è¯æ˜äº†ä¸åŒ Attention Head åˆ†åˆ«è´Ÿè´£æ•æ‰**å±€éƒ¨åºåˆ—è¿ç»­æ€§**ï¼ˆå¯¹è§’çº¿ï¼‰å’Œ**å…¨å±€é”šç‚¹ä¾èµ–**ï¼ˆå‚ç›´æ¡çº¹ï¼‰ã€‚

---

### ğŸ“Š ç»“æœå±•ç¤º

**Self-Attention æœºåˆ¶å¯è§†åŒ–ï¼š**

![Attention Map](assets/multihead_attention_analysis.png)

> *å›¾æ³¨ï¼šå·¦å›¾å±•ç¤ºäº† Head 2 æ•æ‰å±€éƒ¨ä¾èµ–ï¼ˆå½¢æˆ Î±-èºæ—‹çš„è¿ç»­æ€§ï¼‰ï¼Œå³å›¾å±•ç¤ºäº† Head 3 æ•æ‰èµ·å§‹ä½ç‚¹çš„å…¨å±€ä¾èµ–ã€‚*

---

### ğŸš€ å¿«é€Ÿå¼€å§‹ (Quick Start)

**1. ç¯å¢ƒé…ç½®**
bash
pip install torch transformers seaborn matplotlib
2. æ¨¡å‹æƒé‡ä¸‹è½½ ç”±äºç‰ˆæƒå’Œæ–‡ä»¶å¤§å°é™åˆ¶ï¼Œè¯·è‡ªè¡Œä» Hugging Face ä¸‹è½½ ProGen2-small æƒé‡ï¼š

Hugging Face Link

å°† pytorch_model.bin, config.json ç­‰æ–‡ä»¶æ”¾å…¥ progen/progen2/ ç›®å½•ã€‚

3. è¿è¡Œæ¨ç†

Bash
python src/inference.py
4. è¿è¡Œå¯è§†åŒ–

Bash
python src/visualize.py
